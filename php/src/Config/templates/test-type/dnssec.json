{
  "type": "dnssec",
  "description": "Test DNSSEC Algorithm",
  "parameters": [
    {
      "identifier": "ALGORITHM"
    },
    {
      "identifier": "KEYSTRENGTH",
      "optional": true
    }
  ],
  "config": {
    "dnsZones": [
      {
        "dnsSecConfig": {
          "algorithm": "ALGORITHM",
          "keyStrength": "KEYSTRENGTH"
        },
        "records": [
          {
            "prefix": "*",
            "ttl": 200,
            "type": "A",
            "data": "IPV4_ADDRESS"
          }
        ]
      },
      {
        "prefix": "unvalidated-",
        "dnsSecConfig": {
          "algorithm": "ALGORITHM",
          "keyStrength": "KEYSTRENGTH",
          "generateDSRecords": false
        },
        "records": [
          {
            "prefix": "*",
            "ttl": 200,
            "type": "A",
            "data": "IPV4_ADDRESS"
          }
        ]
      },
      {
        "prefix": "unsigned-",
        "dnsSecConfig": {
          "algorithm": "ALGORITHM",
          "keyStrength": "KEYSTRENGTH",
          "signZone": false
        },
        "records": [
          {
            "prefix": "*",
            "ttl": 200,
            "type": "A",
            "data": "IPV4_ADDRESS"
          }
        ]
      }
    ],
    "webVirtualHosts": [
      {
        "wildcard": true,
        "content": "OK",
        "sslCertPrefixes": [
          "*"
        ]
      },
      {
        "prefix": "unsigned-",
        "wildcard": true,
        "content": "OK",
        "sslCertPrefixes": [
          "*"
        ]
      },
      {
        "prefix": "unvalidated-",
        "wildcard": true,
        "content": "OK",
        "sslCertPrefixes": [
          "*"
        ]
      }
    ]
  },
  "rules": {
    "dns": {
      "expectedQueries": [
        {
          "type": "A",
          "value": "(?i)^[a-z0-9-]{36}\\.[a-z]+\\.[a-z]+"
        },
        {
          "type": "A",
          "value": "(?i)^[a-z0-9-]{36}\\.unsigned-[a-z]+\\.[a-z]+"
        },
        {
          "type": "A",
          "value": "(?i)^[a-z0-9-]{36}\\.unvalidated-[a-z]+\\.[a-z]+"
        }
      ]
    },
    "webserver": {
      "expectedQueries": 2
    },
    "webserverOptional": false,
    "relationalKey": "HOSTNAME",
    "timeoutSeconds": 3
  }
}