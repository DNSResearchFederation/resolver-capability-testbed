!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.ResolverCapabilityTest=e():t.ResolverCapabilityTest=e()}(window,(function(){return function(t){var e={};function n(r){if(e[r])return e[r].exports;var o=e[r]={i:r,l:!1,exports:{}};return t[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)n.d(r,o,function(e){return t[e]}.bind(null,o));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=0)}([function(t,e,n){"use strict";n.r(e);var r={randomUUID:"undefined"!=typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};let o;const u=new Uint8Array(16);function i(){if(!o&&(o="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!o))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return o(u)}const s=[];for(let t=0;t<256;++t)s.push((t+256).toString(16).slice(1));function c(t,e=0){return(s[t[e+0]]+s[t[e+1]]+s[t[e+2]]+s[t[e+3]]+"-"+s[t[e+4]]+s[t[e+5]]+"-"+s[t[e+6]]+s[t[e+7]]+"-"+s[t[e+8]]+s[t[e+9]]+"-"+s[t[e+10]]+s[t[e+11]]+s[t[e+12]]+s[t[e+13]]+s[t[e+14]]+s[t[e+15]]).toLowerCase()}var a,f=function(t,e,n){if(r.randomUUID&&!e&&!t)return r.randomUUID();const o=(t=t||{}).random||(t.rng||i)();if(o[6]=15&o[6]|64,o[8]=63&o[8]|128,e){n=n||0;for(let t=0;t<16;++t)e[n+t]=o[t];return e}return c(o)},l=function(t,e,n,r){return new(n||(n=Promise))((function(o,u){function i(t){try{c(r.next(t))}catch(t){u(t)}}function s(t){try{c(r.throw(t))}catch(t){u(t)}}function c(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(i,s)}c((r=r.apply(t,e||[])).next())}))},p=function(t,e){var n,r,o,u,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return u={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(u[Symbol.iterator]=function(){return this}),u;function s(u){return function(s){return function(u){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,r&&(o=2&u[0]?r.return:u[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,u[1])).done)return o;switch(r=0,o&&(u=[2&u[0],o.value]),u[0]){case 0:case 1:o=u;break;case 4:return i.label++,{value:u[1],done:!1};case 5:i.label++,r=u[1],u=[0];continue;case 7:u=i.ops.pop(),i.trys.pop();continue;default:if(!(o=i.trys,(o=o.length>0&&o[o.length-1])||6!==u[0]&&2!==u[0])){i=0;continue}if(3===u[0]&&(!o||u[1]>o[0]&&u[1]<o[3])){i.label=u[1];break}if(6===u[0]&&i.label<o[1]){i.label=o[1],o=u;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(u);break}o[2]&&i.ops.pop(),i.trys.pop();continue}u=e.call(t,i)}catch(t){u=[6,t],r=0}finally{n=o=0}if(5&u[0])throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}([u,s])}}},h=function(){function t(){this._requests=[]}return t.prototype.request=function(t){return l(this,void 0,void 0,(function(){var e,n,r,o,u;return p(this,(function(i){switch(i.label){case 0:if(e={hostname:t,time:Date.now()},this._requests.push(e),"undefined"==typeof window)return[3,6];i.label=1;case 1:return i.trys.push([1,4,,5]),[4,window.fetch(t)];case 2:return n=i.sent(),e.status="sent",r=e,o={status:n.status},[4,n.text()];case 3:return r.response=(o.body=i.sent(),o),[2,n];case 4:return u=i.sent(),e.status="failed",e.errorMessage=u.toString(),[3,5];case 5:return[3,7];case 6:return[2,"OK"];case 7:return[2]}}))}))},t.prototype.wait=function(t){return l(this,void 0,void 0,(function(){return p(this,(function(e){return[2,new Promise((function(e){return setTimeout(e,t)}))]}))}))},t.prototype.getUUID=function(){return f()},t.prototype.getPreviousRequests=function(){return this._requests},t.prototype.addDomainPrefix=function(t,e){return e+t},t}(),y=(a=function(t,e){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),d=function(t,e,n,r){return new(n||(n=Promise))((function(o,u){function i(t){try{c(r.next(t))}catch(t){u(t)}}function s(t){try{c(r.throw(t))}catch(t){u(t)}}function c(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(i,s)}c((r=r.apply(t,e||[])).next())}))},b=function(t,e){var n,r,o,u,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return u={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(u[Symbol.iterator]=function(){return this}),u;function s(u){return function(s){return function(u){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,r&&(o=2&u[0]?r.return:u[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,u[1])).done)return o;switch(r=0,o&&(u=[2&u[0],o.value]),u[0]){case 0:case 1:o=u;break;case 4:return i.label++,{value:u[1],done:!1};case 5:i.label++,r=u[1],u=[0];continue;case 7:u=i.ops.pop(),i.trys.pop();continue;default:if(!(o=i.trys,(o=o.length>0&&o[o.length-1])||6!==u[0]&&2!==u[0])){i=0;continue}if(3===u[0]&&(!o||u[1]>o[0]&&u[1]<o[3])){i.label=u[1];break}if(6===u[0]&&i.label<o[1]){i.label=o[1],o=u;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(u);break}o[2]&&i.ops.pop(),i.trys.pop();continue}u=e.call(t,i)}catch(t){u=[6,t],r=0}finally{n=o=0}if(5&u[0])throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}([u,s])}}},v=function(t){function e(e,n){void 0===e&&(e=1),void 0===n&&(n=null);var r=t.call(this)||this;return r._dynamicSubdomains=e,r._fixedSubdomains=n,r}return y(e,t),e.prototype.runTest=function(t,e,n){return d(this,void 0,void 0,(function(){var r,o,u,i=this;return b(this,(function(s){for(r=this.getUUID(),o=t,this._fixedSubdomains&&(o=this._fixedSubdomains+"."+o),u=0;u<this._dynamicSubdomains;u++)o=r+"."+o;return this.request("http"+(e.insecure?"":"s")+"://"+o).then((function(){n&&n(i.getPreviousRequests())})),[2]}))}))},e}(h),w=function(){function t(){this._store={}}return t.prototype.getItem=function(t){return this._store[t]},t.prototype.setItem=function(t,e){this._store[t]=e},t}(),m=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),g=function(t,e,n,r){return new(n||(n=Promise))((function(o,u){function i(t){try{c(r.next(t))}catch(t){u(t)}}function s(t){try{c(r.throw(t))}catch(t){u(t)}}function c(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(i,s)}c((r=r.apply(t,e||[])).next())}))},_=function(t,e){var n,r,o,u,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return u={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(u[Symbol.iterator]=function(){return this}),u;function s(u){return function(s){return function(u){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,r&&(o=2&u[0]?r.return:u[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,u[1])).done)return o;switch(r=0,o&&(u=[2&u[0],o.value]),u[0]){case 0:case 1:o=u;break;case 4:return i.label++,{value:u[1],done:!1};case 5:i.label++,r=u[1],u=[0];continue;case 7:u=i.ops.pop(),i.trys.pop();continue;default:if(!(o=i.trys,(o=o.length>0&&o[o.length-1])||6!==u[0]&&2!==u[0])){i=0;continue}if(3===u[0]&&(!o||u[1]>o[0]&&u[1]<o[3])){i.label=u[1];break}if(6===u[0]&&i.label<o[1]){i.label=o[1],o=u;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(u);break}o[2]&&i.ops.pop(),i.trys.pop();continue}u=e.call(t,i)}catch(t){u=[6,t],r=0}finally{n=o=0}if(5&u[0])throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}([u,s])}}},P=function(t){function e(){return t.call(this)||this}return m(e,t),e.prototype.runTest=function(t,e,n){return g(this,void 0,void 0,(function(){var r,o,u;return _(this,(function(i){return r=this.getUUID(),o=r+".ttl10."+t,u=r+".ttl15."+t,this.doubleRequest(o,e,n,5e3),this.doubleRequest(u,e,n,1e4),[2]}))}))},e.prototype.doubleRequest=function(t,e,n,r){return g(this,void 0,void 0,(function(){var o=this;return _(this,(function(u){switch(u.label){case 0:return this.request("http"+(e.insecure?"":"s")+"://"+t+"?request=1").then((function(){n&&n(o.getPreviousRequests())})),[4,this.wait(r)];case 1:return u.sent(),this.request("http"+(e.insecure?"":"s")+"://"+t+"?request=2").then((function(){n&&n(o.getPreviousRequests())})),[2]}}))}))},e}(h),x=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),q=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return x(e,t),e.prototype.runTest=function(t,e,n){var r=this,o=this.getUUID(),u=o+"."+t,i=o+"."+this.addDomainPrefix(t,"ipv4-");this.request("http"+(e.insecure?"":"s")+"://"+u).then((function(){n&&n(r.getPreviousRequests())})),this.request("http"+(e.insecure?"":"s")+"://"+i).then((function(){n&&n(r.getPreviousRequests())}))},e}(h),S=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),O=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return S(e,t),e.prototype.runTest=function(t,e,n){var r=this,o="apples."+t,u="pears."+t,i="oranges."+t;this.request("http"+(e.insecure?"":"s")+"://"+o).then((function(){n&&n(r.getPreviousRequests())})),this.request("http"+(e.insecure?"":"s")+"://"+u).then((function(){n&&n(r.getPreviousRequests())})),this.wait(500),this.request("http"+(e.insecure?"":"s")+"://"+i).then((function(){n&&n(r.getPreviousRequests())}))},e}(h),R=function(){function t(t,e,n,r){this.testTypeRunners={ipv6:new q,"qname-minimisation":new v(1,"qname.resolver.capability"),"minimum-ttl":new P,dnssec:new v(1),"dnssec-unsigned":new v(1),"dnssec-unvalidated":new v(1),"tcp-fallback":new v(1,"b9599170-17cc-46ab-b01c-67c2731f8dab.b9599170-17cc-46ab-b01c-67c2731f8dab.b9599170-17cc-46ab-b01c-67c2731f8dab.b9599170-17cc-46ab-b01c-67c2731f8dab.b9599170-17cc-46ab-b01c-67c2731f8dab"),"aggressive-nsec":new O},n||(n={});var o="resolvertest."+t+"."+e;if(!n.multipleRequestsPerSession){if(this.sessionStorage.getItem(o))return;this.sessionStorage.setItem(o,"1")}this.testTypeRunners[t].runTest(e,n,r)}return Object.defineProperty(t.prototype,"installedTestTypeRunners",{get:function(){return this.testTypeRunners},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"sessionStorage",{get:function(){return"undefined"!=typeof sessionStorage?sessionStorage:t.mockSessionStorage},enumerable:!1,configurable:!0}),t.TestTypeRunner=h,t.mockSessionStorage=new w,t}();e.default=R}]).default}));